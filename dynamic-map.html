<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bus Routes - Pragati Engineering College</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            overflow: hidden;
        }

        #map {
            height: 100vh;
            width: 100%;
        }
    </style>
</head>

<body>
    <div id="map"></div>

    <script>
        // Global variables
        let map;
        let markers = [];
        let polylines = [];

        // Pragati Engineering College location (correct coordinates)
        const collegeLocation = { lat: 17.083056007230727, lng: 82.05445438182011 };

        // Bus routes data with actual locations
        const buses = [
            { id: 1, name: 'Rajahmundry', lat: 17.0005, lng: 81.8040, color: '#667eea' },
            { id: 3, name: 'Kakinada', lat: 16.9891, lng: 82.2711, color: '#dc2626' },
            { id: 4, name: 'Peddapuram', lat: 17.1167, lng: 82.2500, color: '#16a34a' },
            { id: 8, name: 'Samalkot', lat: 17.0833, lng: 82.1333, color: '#fbbf24' },
            { id: 90, name: 'Tuni', lat: 17.0500, lng: 82.1667, color: '#8b5cf6' },
            { id: 12, name: 'Amalapuram', lat: 16.5833, lng: 82.0167, color: '#f59e0b' },
            { id: 15, name: 'Mandapeta', lat: 16.8667, lng: 81.9333, color: '#06b6d4' },
            { id: 22, name: 'Anakapalle', lat: 17.3500, lng: 82.5500, color: '#ef4444' },
            { id: 25, name: 'Ravulapalem', lat: 16.7333, lng: 82.2167, color: '#10b981' },
            { id: 30, name: 'Ramachandrapuram', lat: 16.8333, lng: 82.3000, color: '#f97316' },
            { id: 35, name: 'Razole', lat: 16.7833, lng: 81.8833, color: '#ec4899' },
            { id: 40, name: 'Draksharamam', lat: 17.0833, lng: 82.3500, color: '#14b8a6' }
        ];

        // Calculate distance between two points
        function calculateDistance(lat1, lng1, lat2, lng2) {
            const R = 6371; // Earth's radius in km
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLng = (lng2 - lng1) * Math.PI / 180;
            const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                Math.sin(dLng / 2) * Math.sin(dLng / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            return R * c;
        }

        // Initialize map
        function initMap() {
            console.log('Initializing map with', buses.length, 'buses');

            // Create map
            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 9,
                center: collegeLocation,
                mapTypeId: 'roadmap',
                mapTypeControl: true,
                streetViewControl: false,
                fullscreenControl: true
            });

            // Add college marker
            addCollegeMarker();

            // Add bus markers and routes
            addBusMarkers();

            console.log('Map initialization complete');
        }

        // Add college marker
        function addCollegeMarker() {
            const collegeMarker = new google.maps.Marker({
                position: collegeLocation,
                map: map,
                title: 'Pragati Engineering College, Surampalem',
                icon: {
                    path: google.maps.SymbolPath.CIRCLE,
                    scale: 15,
                    fillColor: '#fbbf24',
                    fillOpacity: 1,
                    strokeColor: '#ffffff',
                    strokeWeight: 3
                },
                label: {
                    text: 'ÔøΩ',
                    fontSize: '20px'
                },
                zIndex: 1000
            });

            const collegeInfo = new google.maps.InfoWindow({
                content: `
                    <div style="padding: 12px; font-family: Inter, sans-serif;">
                        <h3 style="margin: 0 0 8px 0; color: #0f172a; font-size: 16px;">
                            üè´ Pragati Engineering College
                        </h3>
                        <p style="margin: 4px 0; color: #64748b; font-size: 13px;">
                            <strong>Location:</strong> Surampalem, East Godavari
                        </p>
                        <p style="margin: 4px 0; color: #64748b; font-size: 13px;">
                            <strong>Active Routes:</strong> ${buses.length} buses
                        </p>
                    </div>
                `
            });

            collegeMarker.addListener('click', () => {
                collegeInfo.open(map, collegeMarker);
            });

            console.log('College marker added');
        }

        // Add bus markers and route lines
        function addBusMarkers() {
            buses.forEach((bus, index) => {
                // Create bus marker
                const busMarker = new google.maps.Marker({
                    position: { lat: bus.lat, lng: bus.lng },
                    map: map,
                    title: `Bus ${bus.id} - ${bus.name}`,
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        scale: 10,
                        fillColor: bus.color,
                        fillOpacity: 1,
                        strokeColor: '#ffffff',
                        strokeWeight: 2
                    },
                    label: {
                        text: bus.id.toString(),
                        color: '#ffffff',
                        fontSize: '11px',
                        fontWeight: 'bold'
                    },
                    zIndex: 100
                });

                // Calculate distance
                const distance = calculateDistance(
                    bus.lat, bus.lng,
                    collegeLocation.lat, collegeLocation.lng
                );

                // Create info window
                const busInfo = new google.maps.InfoWindow({
                    content: `
                        <div style="padding: 10px; font-family: Inter, sans-serif;">
                            <h4 style="margin: 0 0 6px 0; color: #0f172a; font-size: 14px;">
                                üöå Bus ${bus.id}
                            </h4>
                            <p style="margin: 4px 0; color: #64748b; font-size: 12px;">
                                <strong>Route:</strong> ${bus.name} ‚Üí College
                            </p>
                            <p style="margin: 4px 0; color: #64748b; font-size: 12px;">
                                <strong>Distance:</strong> ${distance.toFixed(1)} km
                            </p>
                        </div>
                    `
                });

                busMarker.addListener('click', () => {
                    busInfo.open(map, busMarker);
                });

                // Create route line
                const routeLine = new google.maps.Polyline({
                    path: [
                        { lat: bus.lat, lng: bus.lng },
                        collegeLocation
                    ],
                    geodesic: true,
                    strokeColor: bus.color,
                    strokeOpacity: 0.6,
                    strokeWeight: 3,
                    map: map,
                    zIndex: 50
                });

                markers.push(busMarker);
                polylines.push(routeLine);

                console.log(`Bus ${bus.id} added at (${bus.lat}, ${bus.lng})`);
            });

            console.log(`Total: ${markers.length} markers, ${polylines.length} routes`);
        }

        // Make initMap available globally
        window.initMap = initMap;
    </script>

    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD735BzVTgQt6ois82KJbv0ZyJvWE_jykg&callback=initMap">
        </script>
</body>

</html>